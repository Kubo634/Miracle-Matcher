# リーグ戦 組み分けプログラム ✨

このプログラムは、リーグ戦の「対戦相手」と「どのリーグに誰が入るか」を、ぜーんぶ自動で決めてくれる、とっても便利なプログラムです！

---

## 📖 このプログラムのすごいところ！

-   **地域ルールをしっかり守ります！** 🤝
    -   「同じ地域にいるチーム同士は、絶対に対戦しない」という一番大事なルールをしっかり守って組み合わせを考えます。

-   **試合数はみんな平等！** ⚖️
    -   「Aチームは5試合なのに、Bチームは1試合…」なんてことがないように、全チームが同じ試合数（このプログラムでは3試合）になるように調整します。

-   **毎回違う組み合わせ！** 🎲
    -   実行するたびに、毎回新しいランダムな組み合わせを作ってくれるので、何度でも新鮮な気持ちでリーグ戦を始められます！

---

## 🤔 どうやって組み合わせを決めているの？

プログラムが苦手な人にも分かるように、どうやって考えているのか、その流れをこっそり教えちゃいますね！

### Step 1: チームの準備 📝

まず、参加してくれる18チーム全員に、「あなたは地域A出身です」「あなたは地域D出身です」みたいに、1つずつ「地域の名札」を付けてあげます。これで、誰がどこの地域のチームなのか一目で分かりますね！

### Step 2: 賢いリーグ分け 🧠

ここが一番の工夫ポイントです！
18チームを4つのリーグ（6チーム、4チーム、4チーム、4チーム）に分けるんですけど、ただ適当に分けるわけじゃないんです。

パーティーでテーブル分けをするとき、同じ会社の人ばかりが同じテーブルに固まらないようにしますよね？ それと同じで、**「各リーグに、いろんな地域のチームがバランス良く入るように」**考えてチームを分けていきます。

具体的には、シャッフルしたチームを1チームずつ、
「このチームが入るのに、一番バランスが良くなるリーグはどこかな…？」
って探して、一番良いリーグに入れてあげるんです。

こうすることで、後の対戦相手探しが、とってもスムーズに進むんですよ♪

### Step 3: ドキドキの対戦決め！ 🧩

リーグ分けが終わったら、いよいよ各リーグの中で対戦相手を決めていきます！

ここでは、まるでパズルを解くみたいに、下の2つのルールを同時に満たす組み合わせを探します。

1.  **同じ地域のチームとは戦わない！** (最重要ルール！)
2.  **すべてのチームが、ちょうど3試合になるようにする！**

このパズル、結構むずかしいんです…。
なので、プログラムは **「条件に合う組み合わせが見つかるまで、色々なパターンを試して、途中でダメになったら一手戻って、また別の道を試す」** という、とっても賢くて粘り強い方法で答えを探してくれます。

もし、あるリーグの組み合わせがどうしても上手くいかなかったら…？
大丈夫です！ そのときは、**Step 2の「リーグ分け」から全部やり直して、うまくいくパターンが見つかるまで、プログラムが何度でも挑戦します！**

こうして、すべての条件をクリアした、完璧な組み合わせが完成するんです！

---

## 💻 使い方 (Docker環境)

このプログラムはDockerコンテナの中で動かすので、パソコンにPythonを直接インストールする必要はなくて、代わりに **DockerとDocker Composeが必要**になります。

### 準備

1.  お使いのパソコンに [Docker](https://www.docker.com/products/docker-desktop/) と Docker Compose が使えるようにしておいてください。
2.  プログラムファイル一式（`main.py`, `Dockerfile`, `docker-compose.yml`など）を、一つのフォルダにまとめてください。

### 実行手順

1.  ターミナル（コマンドプロンプト）を開いて、プログラムファイル一式を置いたフォルダに移動します。

2.  最初に、下のコマンドでコンテナをバックグラウンドで起動します。（初回は少し時間がかかります）
    ```bash
    docker-compose up -d
    ```

3.  コンテナが起動したら、いよいよ組み分けプログラムを実行します！
    ```bash
    docker-compose exec app python main.py
    ```
    実行すると、プログラムが計算を始めて、条件に合った最高の組み合わせを見つけて表示してくれます！

4.  使い終わったら、下のコマンドでコンテナを停止・片付けできます。
    ```bash
    docker-compose down
    ```

---

## ⚙️ 設定を変えたいとき

もし、チームの数やリーグの構成を変えたいときは、`main.py` の中にある、下の部分の数字を変えてみてくださいね。

```python
# --- 設定値 ---
# 地域ごとのチーム数を変えたいとき
REGION_DEFINITIONS = {
    'A': 2, 'B': 1, 'C': 2, 'D': 6, 'E': 1, 'F': 1, 'G': 5
}
# リーグごとのチーム数を変えたいとき
LEAGUE_SIZES = [6, 4, 4, 4]
# 各チームの試合数を変えたいとき
MATCHES_PER_TEAM = 3
```

> **注意！**
> 設定を大きく変えると、条件に合う組み合わせがなかなか見つからなくなっちゃうこともあるので、気をつけてくださいね！

